# Intro

Legend
~~~
X - NOT VULNERABLE
V - VULNERABLE
N - NOT APPLICABLE
- - NOT TESTED
~~~

# RECON

id: 1

## Browser entire application while in burp

id: 1.1

## Consult Public Sources

id: 1.2

* [ ] Google

~~~ 
site:target.com
e:target.com filetype:7z OR filetype:bin OR filetype:bzip2 OR
filetype:egg OR filetype:gzip OR filetype:rar OR filetype:zip OR
filetype:iso OR filetype:dat OR filetype:db OR filetype:sql OR
filetype:indd OR filetype:psd OR filetype:asc OR filetype:csv OR
filetype:docx OR filetype:doc OR filetype:epub
    
Google begränsar antalet ord i en sökning så queryn måste delas upp på två
e:target.com filetype:html OR filetype:htm OR filetype:gdoc OR
filetype:log OR filetype:md OR filetype:odt OR filetype:rtf OR
filetype:odf OR filetype:php OR filetype:ods OR filetype:xls OR
filetype:xlsx OR filetype:conf OR filetype:cnf OR filetype:cfg OR
filetype:temp OR filetype:tmp OR filetype:pdf OR filetype:ppt OR
filetype:txt
    
site:target.com filetype:java OR filetype:bak OR filetype:old OR
filetype:tar OR filetype:rar OR filetype:tgz OR filetype:gz
~~~

* [ ] Other stuff

Bing, Yahoo, Wayback

## Discover Hidden Content (use burp)

id: 1.3

* [ ] Review comments and other client side code to find hidden content

Use burp extension t.ex.

## Discover DNS

* [ ] Reverse DNS lookup
* [ ] Brute force DNS (recon-ng, recon/domain-hosts/brute-hosts, set source, show hosts)
* [ ] Zone-transfer test (fierce -dns target.com)

## Discover Default Content

id: 1.4

* [ ] Run Nikto to discover default content
* [ ] Testa köra direkt mot IP-addressen

## Enumerate Identifier-Specified Functions

id: 1.5

* [ ] Identify instances where specific functions are accessed by url parameters
      Example: /admin.jsp?action=editUser
* [ ] Fuzz those for other actions

## Test for Debug Parameters

   id: 1.6

* [ ] Test debug=true in URLs

Use cluster-bomb attack in Burp

~~~
debug       true
test        yes
hide        1
source      on
~~~

----------------------------------------------------------------------------

# Analyze the Application

## Identify Functionality

* [ ] Core Functionality
* [ ] Security Functionality 
* [ ] Peripheral Functionality (error messages, administratice, logging-functionality)
* [ ] Functionality that diverge from standard GUI appearance, parameter naming, navigation mechanism

## Identify Data Entry Points

POST, GET, WS?

* [ ] Identify the Technologies Used
* [ ] Client side (cookies, scripts, java applets, flash)
* [ ] Server side (server, scripting lang, platform, backend components)
* [ ] Map the Attack Surface
* [ ] Acertain likely internal structure
* [ ] Identify vulnerabilities related to each functionality
* [ ] Formulate plan to attack - Prioritize 

----------------------------------------------------------------------------

# Test Client-Side Controls

##  Test Transmission of Data Via the Client

* [ ] Locate hidden fields, cookies and URL parameters
* [ ] Try to deobfuscate obfuscated data (like viewState or other)
* [ ] Identify Client-Side Controls Over User Input
* [ ] Test if the controls are replicated on server-side
* [ ] Looked for disabled content. `input disabled=true`
* [ ] Test Browser Extension Components (flash, java-applet, etc)

----------------------------------------------------------------------------

# Test the Autentication Mechanism

id: 4.0

* [ ] Understand the Mechanism
* [ ] Locate authentication-related functionality (login, registration, account recovery)
* [ ] Test Password Quality [[OTG-AUTHN-007]]
* [ ] Test for Username Enumeration
* [ ] Identify all areas where usernames are validated (login, registration, forgotten password)
* [ ] Test Resilience to Password Guessing - Lock-out mechanism
* [ ] Test Lock-out Mechanism [[OTG-AUTHN-003]]
* [ ] Test Any Account Recovery Function
* [ ] Check Password Hint, email etc
* [ ] Test Any Remember Me Function
* [ ] Test Any Impersionation Function
* [ ] Test Username Uniqueness
* [ ] Register same usernname twice (if it is blocked, you can use it to enumerare users). If second account is create, test what happens with collisions.
* [ ] Test Predictibility of Autogenerated Credentials If usernames and passwords are autogenerated see if they are generated in a predictable way.
* [ ] Check for Unsafe Transmission of Credentials
* [ ] Check for Unsafe Distribution of Credentials (Send over email)
* [ ] If application use activation-email with URL test how the URLs are created.
* [ ] Test for Insecure Storage
* [ ] Hasing algo of passwords
* [ ] Test for Logic Flaws
* [ ] Test for Fail-Open Conditions
* [ ] Test to submit empty string as the value
* [ ] Remove the name/value pair
* [ ] Submit very long and very short values
* [ ] Submit strings instead of numbers, and vice versa
* [ ] Submit the same named parameter multiple times, with the same and different values
* [ ] Test any Multistage Mechanisms
* [ ] Proceed through all stages but in different sequence

----------------------------------------------------------------------------

# Test the Session Management Mechnaism

id: 5

* [ ] Understand the Session Mechanism

Is the session managed though cookie, query id, or some hidden form?

* [ ] Identify which token is the session identification
* [ ] Test Tokens for Meaning
* [ ] Log in with several usernames and record the tokens recieved. Name the users stuff like A, AA, AAA, AAAAA, AAAAB
* [ ] Analyze token for obfuscation or encoding (base64 etc)
* [ ] Test Tokens for Predictibility
* [ ] Generate and capture a large amount of session tokens
* [ ] Try to identify any patterns
* [ ] If the Session ID is custom-written, use the bit-flipper in burp.
* [ ] Check for Insecure Transmission of Tokens
* [ ] Check for Disclosure of Tokens in Logs
* [ ] Check Mapping of Tokens to Sessions
* [ ] Test Sessions Termination
* [ ] Check if session is terminated on the server side when a user logs out
* [ ] Check for session fixation
* [ ] Check if sessionID is set before user is authenticated
  If the sessionID is not set to authenticated users you can log in with one user, and then go to login-page again, and log in with another user. If no new session-token is issued it is vulnerable to session fixation.
* [ ] Check for CSRF
* [ ] If the app uses CSRF-tokens, test the robustness of those. Can you just use whatever?
* [ ] Check Cookie Scope

----------------------------------------------------------------------------

# Test Access Controls

id: 6.0

* [ ] Check vertical access control - identify admin functions and resources. Check if non-admin can access them.
* [ ] Check horizontal access control - try to reach resources from other user at same level.
* [ ] Test for Insecure Access Control Methods
* [ ] Look out for control methods like access=read, edit=false.
* [ ] Some access control is based on Referer. 
* [ ] HEAD - Container managed access control

----------------------------------------------------------------------------

# Test for Input-Based Vulnerabilities

id: 7.0

Start looking for injections by doing a basic first fuzzing. Analyze the outcome of it.
It is a good idea to use Burps fuzzing-list, but make sure to edit it before.


* [ ] Test for SQL Injection
* [ ] Test to submit single and double quotation-marks.
* [ ] Test for XSS and Other Response Injections
* [ ] Test for Reflected XSS
* [ ] Test for HTTP Header Injection
* [ ] Test for Open Redirection
* [ ] Test for Stored Attacks
* [ ] Test for OS Command Injection
* [ ] Test for Path Traversal
* [ ] Test for Script Injection
* [ ] Test for File Inclusion

----------------------------------------------------------------------------

# Test for Function-Specific Input Vulnerabilities

id 8.0

* [ ] Test for SMTP-injection
* [ ] Test for Native Software Vulnerabilities
* [ ] Test for Buffer Overflows
* [ ] Test for Integer Vulnerabilities
* [ ] Test for Format String Vulnerabilities
* [ ] Test for SOAP Injection
* [ ] Test for LDAP Injection
* [ ] Test for XPath Injection
* [ ] Test for Back-End Request Injection
* [ ] Test for XXE Injection

----------------------------------------------------------------------------

# Test for Logic Flaws

id: 9.0

Identify the key attack surface
	    
* [ ] Test Multistage Processes
  Skip stages. Accessing one stage several times. Look for error messages and debug output.
* [ ] Test Handling of Incomplete Input
* [ ] Test Trust Boundaries
* [ ] Test Transaction Logic

----------------------------------------------------------------------------

# Test for Shared Hosting Vulnerabilities

id: 10.0

* [ ] Test Segregation in Shared Infrastructure
* [ ] Test Segregation Between ASP-Hosted Applications

----------------------------------------------------------------------------

# Test for Application Server Vulnerabilities

id: 11.0

* [ ] Perform a port-scan of machine to identify administrative interface
* [ ] If found, test default credentials.
* [ ] Test for Default Content
* [ ] Scan with Nikto
* [ ] Examine default content found
* [ ] Test for Dangerous HTTP Methods (OTG-CONFIG-006)
* [ ] Use OPTIONS-method to list HTTP Methods available on the server
* [ ] Try each reported method and confirm them
* [ ] Test for Proxy Functionality
* [ ] Test for Virtual Hosting Misconfiguration
* [ ] Send correct Host-header
* [ ] Bogus Host-header
* [ ] The servers ip-address in the host-header
* [ ] No Host-header (use HTTP/1.0 only)
* [ ] Test for Web Server Software Bugs
* [ ] Run Nessus or similar
* [ ] Test for Web Application Firewalling

----------------------------------------------------------------------------

# Miscellaneous Checks

id: 12.0

* [ ] Check for DOM-Based Attacks
* [ ] Code review of every piece of JS received.
* [ ] Identify the following APIs:
  ~~~
  document.location
  document.URL
  document.URLEncoded
  document.referrer
  window.location
  ~~~
* [ ] Identify if any of the input data to above mentioned APIs are passed through the following functions:
  ~~~
  document.write()
  document.writeln()
  document.body.innerHtml
  eval()
  window.execScript()
  window.setInterval()
  window.setTimeout()
  ~~~
* [ ] If the input data is passed through to any of the following functions it might be vulnerable to redirection attack:
  ~~~
  document.location
  document.URL
  document.open()
  window.location.href
  window.navigate()
  window.open()
  ~~~
* [ ] Check for Local Privacy Vulnerabilities
* [ ] Check when cookies expire, if it is in the future the session will be alive until it expires.
* [ ] Check for presence of Headers:
  Expires, Cache-control: no-cache, Pragma, HSTS
* [ ] Check for Weak SSL Cipher
* [ ] Check Same-Origin Policy Configuration
* [ ] Check for /crossdomain.xml
* [ ] Check /clientaccesspolicy.xml

----------------------------------------------------------------------------

# OWASP Testing Guide (OTG) outline

## Configuration and Deployment Management Testing

* [ ] Test Network/Infrastructure Configuration (OTG-CONFIG-001)
* [ ] Test Application Platform Configuration (OTG-CONFIG-002)
* * [ ] Sample files, known files
* * [ ] Comments (can be done in burp - right click target, engagement tools, comments)
* [ ] Test File Extensions Handling for Sensitive Information (OTG-CONFIG-003)
* * [ ] Forced browsing
* * [ ] Search engine
* [ ] Review Old, Backup and Unreferenced Files for Sensitive Information (OTG-CONFIG-004)
* * [ ] Forced browsing
* * [ ] Search engine
* [ ] Enumerate Infrastructure and Application Admin Interfaces (OTG-CONFIG-005)
* [ ] Test HTTP Methods (OTG-CONFIG-006)
  Att göra det med SSL:
  `printf 'OPTIONS / HTTP/1.1\r\nHost: www.example.org\r\n\r\n' | ncat --ssl www.example.org 443`
* [ ] Test HTTP Strict Transport Security (OTG-CONFIG-007)
* [ ] Test RIA cross domain policy (OTG-CONFIG-008)
  crossdomain.xml clientaccesspolicy.xml

## Identity Management Testing

* [ ] Test role definitions (OTG-IDENT-001)

  | Role                | Permission    | Object            | Constraints                           |
  | ------------------- | ------------- | ----------------- | ------------------------------------- |
  | Administrator       | Read          | Customer record   | -                                     |
  | Normal User         | Read          | Customer record   | Only records related to business unit |

* [ ] Test User Registration Process (OTG-IDENT-002)
* [ ] Test Account Provisioning Process (OTG-IDENT-003)
* [ ] Testing for account Enumeration and Guessable User Account (OTG-IDENT-004)
* [ ] Testing for Weak or Unenforced Username Policy (OTG-IDENT-005)

## Authentication Testing

* [ ] Testing for Credentials Transported over an Encrypted Channel (OTG-AUTHN-001)
* [ ] Testing for default credentials (OTG-AUTHN-002) 
* [ ] Testing for Weak lock out mechanism (OTG-AUTHN-003)
* [ ] Testing for bypassing authentication schema (OTG-AUTHN-004)
* [ ] Test remember password functionality (OTG-AUTHN-005)
* [ ] Testing for Browser cache weakness (OTG-AUTHN-006)
* [ ] Testing for Weak password policy (OTG-AUTHN-007)
* [ ] Testing for Weak security question/answer (OTG-AUTHN-008)
* [ ] Testing for weak password change or reset functionalities (OTG-AUTHN-009)
* [ ] Testing for Weaker authentication in alternative channel (OTG-AUTHN-010)
 
## Authorization Testing

* [ ] Testing Directory traversal/file include (OTG-AUTHZ-001)
* [ ] Testing for bypassing authorization schema (OTG-AUTHZ-002)
* [ ] Testing for Privilege Escalation (OTG-AUTHZ-003)
* [ ] Testing for Insecure Direct Object References (OTG-AUTHZ-004)

## Session Management Testing

* [ ] Testing for Bypassing Session Management Schema (OTG-SESS-001)
* [ ] Testing for Cookies attributes (OTG-SESS-002)
* [ ] Testing for Session Fixation (OTG-SESS-003)
* [ ] Testing for Exposed Session Variables (OTG-SESS-004)
* [ ] Testing for Cross Site Request Forgery (CSRF) (OTG-SESS-005)
* [ ] Testing for logout functionality (OTG-SESS-006)
* [ ] Test Session Timeout (OTG-SESS-007)
* [ ] Testing for Session puzzling (OTG-SESS-008)
 
## Input Validation Testing

Check if input gets reflected:
Testable URLS:

Do active scanning in Burp

* [ ] Testing for Reflected Cross Site Scripting (OTG-INPVAL-001)
* [ ] Testing for Stored Cross Site Scripting (OTG-INPVAL-002)
* [ ] Testing for HTTP Verb Tampering (OTG-INPVAL-003)
* [ ] Testing for HTTP Parameter pollution (OTG-INPVAL-004)

### Testing for SQL Injection (OTG-INPVAL-005)

* [ ] Oracle Testing
* [ ] MySQL Testing
* [ ] SQL Server Testing
* [ ] Testing PostgreSQL (from OWASP BSP)
* [ ] MS Access Testing
  
* [ ] Testing for NoSQL injection
* [ ] Testing for LDAP Injection (OTG-INPVAL-006)
* [ ] Testing for ORM Injection (OTG-INPVAL-007)
* [ ] Testing for XML Injection (OTG-INPVAL-008)
* [ ] Testing for SSI Injection (OTG-INPVAL-009)
* [ ] Testing for XPath Injection (OTG-INPVAL-010)
* [ ] IMAP/SMTP Injection (OTG-INPVAL-011)

### Testing for Code Injection (OTG-INPVAL-012)

* [ ] Testing for Local File Inclusion
* [ ] Testing for Remote File Inclusion
* [ ] Testing for Command Injection (OTG-INPVAL-013)
* [ ] Testing for Buffer overflow (OTG-INPVAL-014)
* [ ] Testing for Heap overflow
* [ ] Testing for Stack overflow
* [ ] Testing for Format string
* [ ] Testing for incubated vulnerabilities (OTG-INPVAL-015)
* [ ] Testing for HTTP Splitting/Smuggling (OTG-INPVAL-016)

## Testing for Error Handling

* [ ] Analysis of Error Codes (OTG-ERR-001)
* * [ ] Web-server Error:
* * [ ] Application Error:
* * [ ] Database Error: 
* [ ] Analysis of Stack Traces (OTG-ERR-002)

## Testing for weak Cryptography

* [ ] Testing for Weak SSL/TLS Ciphers, Insufficient Transport Layer Protection (OTG-CRYPST-001)
* * [ ] Bitar:
* * [ ] Issuer:
* [ ] Testing for Padding Oracle (OTG-CRYPST-002)
* [ ] Testing for Sensitive information sent via unencrypted channels (OTG-CRYPST-003)

## Business Logic Testing

* [ ] Test Business Logic Data Validation (OTG-BUSLOGIC-001)
* [ ] Test Ability to Forge Requests (OTG-BUSLOGIC-002)
* [ ] Test Integrity Checks (OTG-BUSLOGIC-003)
* [ ] Test for Process Timing (OTG-BUSLOGIC-004)
* [ ] Test Number of Times a Function Can be Used Limits (OTG-BUSLOGIC-005)
* [ ] Testing for the Circumvention of Work Flows (OTG-BUSLOGIC-006)
* [ ] Test Defenses Against Application Mis-use (OTG-BUSLOGIC-007)
* [ ] Test Upload of Unexpected File Types (OTG-BUSLOGIC-008)
* [ ] Test Upload of Malicious Files (OTG-BUSLOGIC-009)

## Client Side Testing

* [ ] Testing for DOM based Cross Site Scripting (OTG-CLIENT-001)
* [ ] Testing for JavaScript Execution (OTG-CLIENT-002)
* [ ] Testing for HTML Injection (OTG-CLIENT-003)
* [ ] Testing for Client Side URL Redirect (OTG-CLIENT-004)
* [ ] Testing for CSS Injection (OTG-CLIENT-005)
* [ ] Testing for Client Side Resource Manipulation (OTG-CLIENT-006)
* [ ] Test Cross Origin Resource Sharing (OTG-CLIENT-007)
* [ ] Testing for Cross Site Flashing (OTG-CLIENT-008)
* [ ] Testing for Clickjacking (OTG-CLIENT-009)
* [ ] Testing WebSockets (OTG-CLIENT-010)
* [ ] Test Web Messaging (OTG-CLIENT-011)
* [ ] Test Local Storage (OTG-CLI

# A little bit of everything

https://www.netcraft.com/

## Structure

~~~
# Goal

id: goalID

* [ ] Taskname

Description

# Another Goal

* [ ] Another Taskname

~~~



## Notes
